{"version":3,"sources":["cue.js"],"names":["cc","Class","extends","Component","properties","cue","Node","start","Canvas","instance","node","on","EventType","MOUSE_MOVE","onMouseMove","MOUSE_DOWN","onMouseDown","MOUSE_UP","onMouseUp","onwballSleep","event","_mouseDown","opacity","loc","getLocation","_mousePosition","parent","convertToNodeSpaceAR","angle","signAngle","v2","misc","radiansToDegrees","rotation","runAction","repeatForever","moveBy","force","x","stopAllActions","sequence","moveTo","easing","easeSineOut","callFunc","customEvent","Event","EventCustom","dispatchEvent"],"mappings":"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","file":"cue.js","sourceRoot":"..\\..\\..\\assets","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        //球杆的节点\n        cue : cc.Node\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {},\n\n    start () {\n        //鼠标移动系统事件\n        cc.Canvas.instance.node.on(cc.Node.EventType.MOUSE_MOVE, this.onMouseMove, this);\n        //鼠标左键按下系统事件\n        cc.Canvas.instance.node.on(cc.Node.EventType.MOUSE_DOWN, this.onMouseDown, this);\n        //鼠标左键抬起系统事件\n        cc.Canvas.instance.node.on(cc.Node.EventType.MOUSE_UP, this.onMouseUp, this);\n        //白球停止的自定义事件\n        cc.Canvas.instance.node.on(\"wball-sleep\", this.onwballSleep, this);\n    },\n\n    onMouseMove (event) {\n        //按下鼠标时，球杆方向不再移动。球杆隐藏时操作无效\n        if (this._mouseDown || this.node.opacity != 255) {\n            return;\n        }\n        //获取鼠标的当前位置坐标\n        var loc = event.getLocation();\n        this._mousePosition = loc;\n        //将坐标转换到父节点的坐标系下\n        loc = this.node.parent.convertToNodeSpaceAR(loc);\n        //计算与（-1，0）向量的夹脚，该夹脚即为球杆需要转动的角度\n        var angle = loc.signAngle(cc.v2(-1,0));\n        angle = cc.misc.radiansToDegrees(angle);\n        //设置球杆的角度\n        this.node.rotation = angle;\n    },\n\n    onMouseDown (event) {\n        //球杆隐藏时操作无效\n        if (this.node.opacity != 255) {\n            return;\n        }\n        //将按下鼠标的标记设置为true\n        this._mouseDown = true;\n\n        //使球杆向后移动，每秒向后移动50个像素\n        //这里可以将-50这个值提升为组件属性，暴露到属性面板中方便配置调试\n        this.cue.runAction(cc.repeatForever(cc.moveBy(1, cc.v2(-50, 0))));\n    },\n\n    onMouseUp (event) {\n        //球杆隐藏时操作无效\n        if (this.node.opacity !=255) {\n            return;\n        }\n        //计算球杆向后移动的像素，通过这个值来计算击球的力度\n        var force = this.cue.x - 182;\n        //停止球杆向后移动的动作\n        this.cue.stopAllActions();\n        //使用序列动作，先执行\n        this.cue.runAction(cc.sequence(\n            cc.moveTo(0.1, cc.v2(-182,0)).easing(cc.easeSineOut()),\n            cc.callFunc(() => {\n                //将按下鼠标的标记设置为false\n                this._mouseDown = false;\n                //创建自定义事件\"cue\",并派发出去\n                //事件有两个参数，一个是force，通过这个值，白球可以计算击球力度\n                //另一个值为cue，是一个cc.vec2坐标，记录按下时的鼠标位置，这是提供给白球进行角度计算的\n                var customEvent = new cc.Event.EventCustom(\"cue\", true);\n                customEvent.force = force;\n                customEvent.cue = this._mousePosition\n                this.node.dispatchEvent(customEvent);\n                //隐藏球杆\n                this.node.opacity = 0;\n            })\n        ));\n    },\n\n    onwballSleep () {\n        //白球停止时，显示球杆\n        this.node.opacity = 255;\n    },\n\n    // update (dt) {},\n});\n"]}